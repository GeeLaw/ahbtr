We first define \emph{traceability} of AH-BTR using one comprehensive experiment,
then consider two simpler security properties, called \emph{completeness} and \emph{soundness}, whose conjunction is equivalent to traceability.
We will deal with the simpler notions later.

\begin{definition}[traceability]\label{def:tracing-security}
An AH-BTR scheme $(\Gen,\Enc,\Dec,\Trace)$ per Definition~\ref{def:ahbtr} is \emph{traceable}
if all efficient adversary wins $\ExpTrace$ only with negligible probability,
where $\ExpTrace(1^\lambda)$ with adversary~$\scriptB$ proceeds as follows:
\begin{security}
\phase{Setup}
Launch $\scriptB(1^\lambda)$ and receive $1^Q$ from it.
Let ${S\gets[Q]}$ and run
\begin{align*}
(\pk_q,\sk_q)\draws\Gen(1^\lambda)\qquad\textup{for }q\in[Q],
\end{align*}
and send $\{\pk_q\}_{q\in[Q]}$ to $\scriptB$.
\phase{Query}
Repeat the following for arbitrarily many rounds determined by~$\scriptB$.
In each round, $\scriptB$ submits ${t\in[Q]}$ for~$\sk_t$.
Upon the query, let ${S\gets S\setminus\{t\}}$ and send $\sk_t$ to~$\scriptB$.
\phase{Challenge}
$\scriptB$ outputs a (probabilistic) circuit~$\scriptD$,
a list $\{\pk^\ast_j\}_{j\in[N]}$ of public keys, and
an error bound~$1^{1/\epsilon^\ast}$.
Run
\begin{align*}
i^\ast\draws\Trace^\scriptD(1^\lambda,\{\pk^\ast_j\}_{j\in[N]},1^{1/\epsilon^\ast}).
\end{align*}
Let
\begin{itemize}
\item $\DistinctPKs$ be the event that the public keys in $\{\pk^\ast_j\}_{j\in[N]}$ are \emph{distinct},
\item $\FalsePos$ the event that ${i^\ast\in[N]}$ and ${\pk^\ast_{i^\ast}=\pk_s}$ for some ${s\in S}$,
\item $\GoodDist$ the event that
\begin{align*}
\left|\Pr\left[
\begin{aligned}
\mu_0&{}\draws\bit^\lambda,\qquad
\mu_1\draws\bit^\lambda\\
\beta&{}\draws\bit\\
\ct&{}\draws\Enc(1^\lambda,\{\pk^\ast_j\}_{j\in[N]},\mu_\beta)
\end{aligned}
\::\:
\scriptD(\mu_0,\mu_1,\ct)=\beta
\right]-\frac12
\right|
\geq\epsilon^\ast,
\end{align*}
\item and
\luoji{Need motivation in introduction!
There're two kinds of adversarial public keys.
One is correctly sampled but secret key is leaked.
The other is adversarially sampled (could be malformed)!
Definitions must take the latter scenario into account.
The tracing algorithm does \emph{not} necessarily identify a public key sampled by the experiment as a traitor.}
$\NotFound$ the event that ${i^\ast\notin[N]}$ (i.e., ${i^\ast=\bot}$).
\end{itemize}
$\scriptB$ \emph{wins} if and only if ${\DistinctPKs\wedge(\FalsePos\vee(\GoodDist\wedge\NotFound))}$.
\end{security}
\end{definition}
