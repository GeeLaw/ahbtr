\begin{proof}[\hyperanchor{pf:ahbtr-from-ahplbe}{Theorem~\ref{thm:ahbtr-from-ahplbe}}]
Consider any efficient adversary~$\scriptB$ against the traceability of Construction~\ref{con:ahbtr-from-ahplbe}.

\luoji{Consider acknowledging Hoeteck for the write-up style.}
Let $\GoodEst$ be the event that ${|\widehat{\epsilon}_i-\epsilon_i|\leq\delta}$ for all~${i\in[0..N]}$.
% $N$ is a random variable (and $\delta,\eta$ are functions of~$N$).
% It is incorrect to say
% \begin{align*}
% \Pr[\neg\GoodEst]\leq 2({N+1})\exp({-2\delta^2\eta}),
% \end{align*}
% as the left-hand side is a number (integration has been done with respect to the probability measure)
% whereas the right-hand side is not a number (it is a function from the sample space of the probability space).
By the Chernoff bound, the union bound, and the law of total probability,
\begin{align*}
\Pr[\neg\GoodEst]
=\E\bigl[\Pr[\neg\GoodEst\mid N]\bigr]
\leq\E[2({N+1})\exp({-2\delta^2\eta})]
\leq 2^{-\lambda}.
\end{align*}
Let $\BadEnd$ be the event that ${|\epsilon_N|>\frac{\epsilon^\ast}{2}}$,
then ${\GoodDist\wedge\neg\BadEnd}$ implies
% Here, ``implies'' means ``is a superset of'' (relation between events).
\begin{align*}
\max_{i\in[N]}{|\epsilon_{i-1}-\epsilon_i|}
&{}\geq
\frac1N\sum_{i=1}^{N}{|\epsilon_{i-1}-\epsilon_i|}
\geq
\frac1N\left|\sum_{i=1}^{N}{(\epsilon_{i-1}-\epsilon_i)}\right|
=
\frac1N|\epsilon_0-\epsilon_N|
\\&{}\geq
\frac1N(
% \GoodDist is \smash'ed and needs \vphantom to restore height.
\underset{\mathclap{\substack{\uparrow\\{\GoodDist}\quad\vphantom{G}}}}{|\epsilon_0|}
-
\underset{\mathclap{\substack{\uparrow\\\quad{\neg\BadEnd}\vphantom{G}}}}{|\epsilon_N|}
)
\geq
\frac1N\left(
\epsilon^\ast
-\frac{\epsilon^\ast}{2}
\right)
=
\frac{\epsilon^\ast}{2N}
=
5\delta.
\end{align*}
Therefore, ${\GoodDist\wedge\neg\BadEnd\wedge\GoodEst}$ implies
\begin{align*}
\max_{i\in[N]}{|\widehat{\epsilon}_{i-1}-\widehat{\epsilon}_i|}
\underset{\mathclap{\substack{
% \GoodEst is \smash'ed and needs \vphantom to restore height.
\big\uparrow\\\GoodEst\vphantom{G}
}}}{\geq}
\max_{i\in[N]}{(|\epsilon_{i-1}-\epsilon_i|-2\delta)}
\underset{\mathclap{\substack{
\big\uparrow\\\GoodDist\wedge\neg\BadEnd\vphantom{G}
}}}{\geq}
5\delta-2\delta
=
3\delta,
\end{align*}
which in turn implies ${T\neq\varnothing}$ hence ${i^\ast\in[N]}$, i.e.,
${\neg\NotFound}$.
By contraposition,
\begin{align*}
\GoodDist\wedge\NotFound\wedge\GoodEst
\quad\Longrightarrow\quad
\BadEnd.
\end{align*}
The following claims hold:

\begin{claim}[\hyperlink{pf:ahbtr-from-ahplbe-badend}{\P}]\label{clm:ahbtr-from-ahplbe-badend}
$\Pr[\GoodPKs\wedge\BadEnd]=\negl(\lambda)$.
\end{claim}

\begin{claim}[\hyperlink{pf:ahbtr-from-ahplbe-falsepos}{\P}]\label{clm:ahbtr-from-ahplbe-falsepos}
$\Pr[\GoodPKs\wedge\FalsePos\wedge\GoodEst]=\negl(\lambda)$.
\end{claim}

\noindent
Once Claims~\ref{clm:ahbtr-from-ahplbe-badend} and~\ref{clm:ahbtr-from-ahplbe-falsepos} are proved,
it follows that
\begin{align*}
\WideNarrow{}{&}
\Pr[\scriptB\textup{ wins}]
\WideNarrow{\leq{}&}{\\{}\leq{}&}
\Pr[\neg\GoodEst]
+
\Pr[(\scriptB\textup{ wins})\wedge\GoodEst]
\WideNarrow{}{\displaybreak[3]}\\{}\leq{}&
2^{-\lambda}
+
\Pr[\GoodPKs\wedge(\FalsePos\vee(\GoodDist\wedge\NotFound))\wedge\GoodEst]
\displaybreak[3]\\{}\leq{}&
2^{-\lambda}
+
\Pr[\GoodPKs\wedge\FalsePos\wedge\GoodEst]
\\&\hphantom{2^{-\lambda}}
+
\Pr[\GoodPKs\wedge\GoodDist\wedge\NotFound\wedge\GoodEst]
\displaybreak[3]\\{}\leq{}&
2^{-\lambda}
+
\Pr[\GoodPKs\wedge\FalsePos\wedge\GoodEst]
+
\Pr[\GoodPKs\wedge\BadEnd]
\\{}={}&
2^{-\lambda}+\negl(\lambda)+\negl(\lambda)
=
\negl(\lambda).
\qedhere
\end{align*}
\end{proof}

\input{ahbtr/from-ahplbe/proof-badend}

\input{ahbtr/from-ahplbe/proof-falsepos}
