\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{xcolor}
\usepackage{float,graphicx}
\usepackage{tabularx,booktabs,multirow}
\usepackage{relsize}

\usepackage{afterpage}
\def\clearfloats{\afterpage{\clearpage}}

\usepackage[normalem]{ulem}
\usepackage[outline]{contour}

\def\ul#1{\uline{#1}}

\newif\ifLaomianInsideCallout@
\LaomianInsideCallout@false
\usepackage[backgroundcolor=white!0,linecolor=black!70,bordercolor=black!70,textsize=footnotesize]{todonotes}

% Prevent \subparagraph completely.
\let\subparagraph\Laomian@undefined

% Use pink page borders and notes.
\ifLaomianDraft@
\let\Laomian@Gm@pageframes@bak\Gm@pageframes
\def\Gm@pageframes{\begingroup\color{red!50}\Laomian@Gm@pageframes@bak\endgroup}
% Rotate among these colors for call-outs.
\definecolor{LaomianCalloutColorA}{rgb}{0.965,0.365,0.208}
\definecolor{LaomianCalloutColorB}{rgb}{0.506,0.733,0.020}
\definecolor{LaomianCalloutColorC}{rgb}{1.000,0.729,0.027}
\definecolor{LaomianCalloutColorD}{rgb}{0.016,0.647,0.941}
\def\Laomian@CalloutColorName{LaomianCalloutColorA}
\def\Laomian@CalloutColorNameA{LaomianCalloutColorB}
\def\Laomian@CalloutColorNameB{LaomianCalloutColorC}
\def\Laomian@CalloutColorNameC{LaomianCalloutColorD}
\def\Laomian@CalloutColorNameD{}
\def\Laomian@CalloutColorRotate{%
  \global\let\Laomian@CalloutColorNameD\Laomian@CalloutColorName%
  \global\let\Laomian@CalloutColorName\Laomian@CalloutColorNameA%
  \global\let\Laomian@CalloutColorNameA\Laomian@CalloutColorNameB%
  \global\let\Laomian@CalloutColorNameB\Laomian@CalloutColorNameC%
  \global\let\Laomian@CalloutColorNameC\Laomian@CalloutColorNameD%
}
\def\defcallout#1#2{\def#1##1{%
  \ifLaomianInsideCallout@%
    \\\textbf{#2:} ##1%
  \else%
    \LaomianInsideCallout@true
    \leavevmode%
    \todo[%
      linecolor=\Laomian@CalloutColorName,%
      bordercolor=\Laomian@CalloutColorName%
    ]{\textbf{#2:} ##1}%
    \LaomianInsideCallout@false%
    \Laomian@CalloutColorRotate%
    \ignorespaces%
  \fi%
}}
\else
\def\defcallout#1#2{\def#1##1{\ignorespaces}}
\fi
\AtBeginDocument{\let\defcallout\Laomian@undefined}

% Anonymity (\TypesetAcknowledgement and \maketitle).
% Also handles page style for \maketitle.
\ifLaomianAnonymous@
\let\TypesetAcknowledgement\relax
\AtBeginDocument{%
  % Back up the title commands.
  \let\Laomian@author@bak\author
  \let\Laomian@authorrunning@bak\authorrunning
  \let\Laomian@institute@bak\institute
  \let\Laomian@maketitle@bak\maketitle
  % Replace the authorship commands.
  \let\author\Laomian@EatOneArgument%
  \let\authorrunning\Laomian@EatOneArgument%
  \let\institute\Laomian@EatOneArgument%
  % Restore the authorship commands right before \maketitle.
  \def\maketitle{%
    \let\author\Laomian@author@bak%
    \let\authorrunning\Laomian@authorrunning@bak%
    \let\institute\Laomian@institute@bak%
    \let\maketitle\Laomian@maketitle@bak%
    \let\Laomian@author@bak\Laomian@undefined%
    \let\Laomian@authorrunning@bak\Laomian@undefined%
    \let\Laomian@institute@bak\Laomian@undefined%
    \let\Laomian@maketitle@bak\Laomian@undefined%
    \author{}%
    \authorrunning{}%
    \institute{}%
    \maketitle%
    \Laomian@TitlePageStyle%
    \vspace*{-7.5ex}%
  }%
}
\else
\def\TypesetAcknowledgement{\input{acknowledgement}}
\AtBeginDocument{%
  \let\Laomian@maketitle@bak\maketitle%
  \def\maketitle{%
    \let\maketitle\Laomian@maketitle@bak%
    \let\Laomian@maketitle@bak\Laomian@undefined%
    \maketitle%
    \Laomian@TitlePageStyle%
  }%
}
\fi

% Page limits.
\ifLaomianPageLimits@
\def\pagelimitsnolimits#1#2{#1}
\long\def\PageLimitsNoLimits#1#2{#1}
\else
\def\pagelimitsnolimits#1#2{#2}
\long\def\PageLimitsNoLimits#1#2{#2}
\fi

% IACR copyright notice.
\ifLaomianCopyright@
\def\IACRCopyright#1{%
  \begingroup%
  \def\@makefntext##1{\noindent ##1}%
  \footnotetext{#1}%
  \endgroup%
}
\else
\let\IACRCopyright\Laomian@EatOneArgument
\fi

% Table of contents (default).
\let\TypesetTableOfContents\relax
\let\Laomian@BibInTOC@Begin\relax
\let\Laomian@BibInTOC@End\relax
\let\Laomian@AppendixInTOC\relax

% Bibliography.
\AtBeginDocument{\def\doi#1{\url{https://doi.org/#1}}}
\ifLaomianNumericBib@
\def\bibalphanumeric#1#2{#2}
\long\def\BibAlphaNumeric#1#2{#2}
\usepackage[noadjust,nomove]{cite}
\def\TypesetBibliography#1{%
  \bibliographystyle{.laomian/splncs04}%
  \Laomian@BibInTOC@Begin%
  \bibliography{#1}%
  \Laomian@BibInTOC@End%
}
\else
\def\bibalphanumeric#1#2{#1}
\long\def\BibAlphaNumeric#1#2{#1}
\usepackage[noadjust,nomove,nosort,nocompress]{cite}
\def\TypesetBibliography#1{%
  \bibliographystyle{alpha}%
  \Laomian@BibInTOC@Begin%
  \bibliography{#1}%
  \Laomian@BibInTOC@End%
}
\fi

\mathchardef\citeprepenalty=0
\def\citeleft{[}
\def\citeright{]}
\def\citepunct{,\hspace{0pt}}
\def\citedash{--\penalty10000\relax}
\def\citemid{; }

% Appendix (supplementary materials).
\ifLaomianSupplementary@
\def\Laomian@AppendixName{Supplementary Materials}
\def\Laomian@AppendixTitle{\begin{center}\huge\bfseries\Laomian@AppendixName\end{center}}
\else
\def\Laomian@AppendixName{Appendix}
\let\Laomian@AppendixTitle\relax
\fi

\def\TypesetAppendix{%
  \clearpage%
  \Laomian@AppendixInTOC%
  \Laomian@AppendixTitle%
  \appendix%
}

% Security experiments.
\def\security{%
  \begin{itemize}%
  \upshape%
}
\def\endsecurity{\end{itemize}}
\def\phase#1{\item{\bfseries\upshape #1.}}%
