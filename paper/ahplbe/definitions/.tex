\begin{definition}[AH-PLBE]\label{def:ahplbe}
An \emph{\ad hoc private linear broadcast encryption (AH-PLBE) scheme}
(with message space~$\bit^\lambda$)
consists of 3 efficient algorithms:
\begin{itemize}
\item $\Gen(1^\lambda)$ outputs a pair~$(\pk,\sk)$ of public and private keys.
\item $\Enc(1^\lambda,\{\pk_i\}_{i\in[N]},i_\bot\in[0..N],m\in\bit^\lambda)$
takes as input
\luoji{Should motivate this requirement in the technical overview.
Emphasize \textbf{lexicographically sorted, distinct} for security.
In contrast, it is not necessary to say this for $\Dec$ as it has nothing to do with security.}
a \textbf{lexicographically sorted} list of \textbf{distinct} public keys,
an index,
and a message.
It outputs a ciphertext~$\ct$.
\item $\Dec^{\{\pk_i\}_{i\in[N]}}(1^\lambda,N,j\in[N],\sk,\ct)$
is given random access to a list of public keys and
takes as input
the length of the list,
an index,
a secret key, and
a ciphertext.
It outputs a message.
\end{itemize}
\luoji{There is no guarantee that the public keys collide with only negligible probability.
Since we do not really care about PLBE, we should prove a theorem that a secure \ad hoc broadcast and trace have negligible collision probability.
Also consider proving the analogue of Remark~3 in~\cite{C:Zhandry20}.}
The scheme must be \emph{correct}, i.e., for all
${\lambda\in\doubleN}$,
${N\in\doubleN}$,
${m\in\bit^\lambda}$,
${j\in[N]}$,
\begin{align*}
\WideNarrow{}{\small}
\Pr\left[
\begin{aligned}
(\pk_i,\sk_i)&{}\draws\Gen(1^\lambda)
\textup{ for }i\in[N]\\
\ct
\WideNarrow{}{\hspace*{2em}}&\WideNarrow{}{\hspace*{-2em}}
{}\draws\Enc(1^\lambda,\{\pk_i^\ast\}_{i\in[N]},0,m)
\end{aligned}
\::\:
\begin{aligned}
&\Dec^{\{\pk_i^\ast\}_{i\in[N]}}(1^\lambda,N,j,\sk_j^\ast,\ct)=m
\\\textup{or }&\exists\, i,i'\in[N]:(i\neq i')\wedge(\pk_i=\pk_{i'})
\end{aligned}
\right]=1,
\end{align*}
where $\{(\pk_i^\ast,\sk_i^\ast)\}_{i\in[N]}$ is
the lexicographically sorted $\{(\pk_i,\sk_i)\}_{i\in[N]}$.
\end{definition}

\noindent
The above definition of correctness does not take into account
% Since an adversarially generated key could be ``well-formed'',
% the correct phrasing is ``adversarially generated'', but it is a mouthful.
adversarially generated (malformed) public keys.
It is easy though tedious
% It is left as an exercise for the reader
to define \emph{robustness} so that normally generated key pairs enjoy correctness even if the list contains malformed public keys
and show that a tweaked version of Construction~\ref{con:ahplbe} achieves robustness.
