\subsubsection{Developing Definitions.}
We start with the first principles of \ad hoc traitor tracing.
Syntactically, there should be a key generation algorithm that is run by each user of the system.%
\footnote{We aim for a scheme without any trusted party, so there should be no global set-up.}
To encrypt, a list of public keys is used to identify the set of recipients.
Decryption should only require one secret key from the list of public keys.
In addition, the decryptor gets random access to all the recipients' public keys as well as the ciphertext.
The choice to give random access to these inputs is based on performance concerns, as the decryptor might not have to read all of the public keys or the ciphertext.

It should be clear that such a scheme would automatically have the functionality of broadcast encryption~\cite{C:FiaNao93}.%
\footnote{Decentralized versions of broadcast encryption were studied in~\cite{SCN:PhaPoiStr12,PAIRING:DelPaiPoi07} with interactive management of recipient sets.
\Ad hoc (threshold) broadcast encryption was studied in~\cite{DHMR08,CCS:WQZD10} with constructions for bounded schemes requiring global set-up.}
There is no event prior to encryption that ``binds'' the system to a specific, fixed set of possible recipients, and the encryptor is free to use whatever public keys it sees fit.
Similarly, the encryptor can remove any public key when it encrypts a second ciphertext, i.e., the scheme supports revocation.
Therefore, the object is named \ad hoc broadcast, trace, and revoke (AH-BTR).

As usual with broadcast encryption, we do not hide the list of recipients.
Hiding the recipients makes ciphertext
% Hack
\WideNarrow{\pagebreak[3]}{}%
grow at least linearly with the number of recipients,
diminishing the potential of efficiency.
As we shall see, it is possible to construct AH-BTR with short ciphertexts.

Due to the decentralized nature of such systems,
an adversary might indistinguishably generate malformed keys,
which could potentially evade tracers that only take well-formed keys into account.
To make it worse, a malformed key could be used to mount a denial-of-service attack against (other) honest users if it appears in the list of recipients' public keys during encryption ---
the encryption algorithm might have been carelessly designed and the presence of certain malformed keys could make it impossible to decrypt for anyone, including the recipients with honestly generated public keys.

In order to protect against such attacks by definition,
we require correctness be \emph{robust} against malformed keys ---
however, for performance reasons, namely to be able to index into any particular public key in constant time,
we reject \emph{blatantly} malformed keys, e.g., those of incorrect lengths, in the definition of correctness.
This restriction does not hamper the usefulness of such a scheme.

As for security,
when attacking the \emph{traceability} of the scheme, the adversary is allowed to supply an arbitrary list of recipients' public keys, generated honestly by the challenger or (adversarially) by the adversary, so that the definition covers the scenario when (blatantly or not) malformed keys are present in the list of recipients' public keys.
The tracing algorithm is given oracle access to a stateless%
\footnote{The general transformation~\cite{DRM:KiaYun01,EC:BonSahWat06} to deal with stateful decoder applies to our definition of AH-BTR, \textit{mutatis mutandis}.}
decoder.
It must \emph{not accuse} an honest user, defined as one whose public key is generated by the challenger without its secret key revealed to the adversary.
It \emph{must find} a traitor as long as the decoder has sufficient advantage (i.e., succeeds in decrypting with sufficient probability), where \emph{traitors} are associated with public keys in the recipient list that are either generated by the challenger with their secret keys revealed to the adversary or crafted by the adversary in any manner (e.g., skewed distribution, or even without a well-defined secret key).

Once the issues above are identified and conceptually resolved (as done here),
it is straight-forward to define AH-BTR analogously to traditional broadcast, revoke, and trace schemes~\cite{FC:NaoPin00,C:NaoNaoLot01,C:GQWW19}.
