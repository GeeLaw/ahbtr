\begin{definition}[traceability]\label{def:tracing-security}
An AH-BTR scheme $(\Gen,\Enc,\Dec,\Trace)$ per Definition~\ref{def:ahbtr} is \emph{traceable}
if all efficient adversary wins $\ExpTrace$ only with negligible probability,
where $\ExpTrace(1^\lambda)$ with adversary~$\scriptB$ proceeds as follows:
\begin{security}
\phase{Setup}
Launch $\scriptB(1^\lambda)$ and receive $1^Q$ from it.
Initialize the set $S$ to $[Q]$, run
\begin{align*}
(\pk_q,\sk_q)\draws\Gen(1^\lambda)\qquad\textup{for }q\in[Q],
\end{align*}
and send $\{\pk_q\}_{q\in[Q]}$ to $\scriptB$.
\phase{Query}
Repeat the following for arbitrarily many rounds determined by~$\scriptB$.
In each round, $\scriptB$ submits ${t\in[Q]}$ for~$\sk_t$.
% This is awful.
\WideNarrow
{Upon the query, remove~$t$~from~$S$~and~send~$\sk_t$~to~$\scriptB$.}
{Upon the query, remove $t$ from the set $S$ and send $\sk_t$ to~$\scriptB$.}
\phase{Challenge}
$\scriptB$ outputs a (probabilistic) circuit~$\scriptD$,
a list $\{\pk^\ast_j\}_{j\in[N]}$ of public keys, and
an error bound~$1^{1/\epsilon^\ast}$.
Run
\begin{align*}
i^\ast\draws\Trace^\scriptD(1^\lambda,\{\pk^\ast_j\}_{j\in[N]},1^{1/\epsilon^\ast}).
\end{align*}
Let
\begin{itemize}
\item $\FalsePos$ be the event that ${i^\ast\in[N]}$ and ${\pk^\ast_{i^\ast}=\pk_s}$ for some ${s\in S}$,
\item $\GoodDist$ the event that
\begin{align*}
\left|\Pr\left[
\begin{aligned}
\mu_0&{}\draws\bit^\lambda,\qquad
\mu_1\draws\bit^\lambda\\
\beta&{}\draws\bit\\
\ct&{}\draws\Enc(1^\lambda,\{\pk^\ast_j\}_{j\in[N]},\mu_\beta)
\end{aligned}
\::\:
\scriptD(\mu_0,\mu_1,\ct)=\beta
\right]-\frac12
\right|
\geq\epsilon^\ast,
\end{align*}
\item and
$\NotFound$ the event that ${i^\ast\notin[N]}$ (i.e., ${i^\ast=\bot}$).
\end{itemize}
$\scriptB$ \emph{wins} if and only if ${\FalsePos\vee(\GoodDist\wedge\NotFound)}$.
\end{security}
\end{definition}

\noindent
Similar to Remark~3 in~\cite{EPRINT:Zhandry20a},
traceability implies KEM security (omitted here).
% It also follows that a traceable scheme will have negligible collision probability for~$\pk$.

% Good exercise for the reader to define KEM security and prove it!
